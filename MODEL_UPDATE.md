# ğŸ¨ æ¨¡å‹æ›´æ–° - FLUX.1 Schnellå›¾åƒç”Ÿæˆæ”¯æŒ

**æ›´æ–°æ—¶é—´**: 2025-10-28  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“‹ æ›´æ–°å†…å®¹

### âœ… ç§»é™¤ä¸å¯ç”¨çš„æ¨¡å‹

æ ¹æ®å®é™…æµ‹è¯•åé¦ˆï¼Œä»¥ä¸‹æ¨¡å‹å·²è¢«ç§»é™¤ï¼š

#### âŒ å·²ç§»é™¤
1. **Qwen 1.5 7B Chat** - æ— æ³•è®¿é—®
2. **Whisper** (è¯­éŸ³è¯†åˆ«) - æ— æ³•ä½¿ç”¨
3. **BGE Base EN V1.5** (æ–‡æœ¬åµŒå…¥) - æ— æ³•ä½¿ç”¨
4. **BGE Small EN V1.5** (æ–‡æœ¬åµŒå…¥) - æ— æ³•ä½¿ç”¨

### âœ… æ–°å¢æ¨¡å‹

#### ğŸ¨ FLUX.1 Schnell
- **æ¨¡å‹ID**: `@cf/black-forest-labs/flux-1-schnell`
- **æä¾›å•†**: Black Forest Labs
- **ä»»åŠ¡ç±»å‹**: æ–‡æœ¬è½¬å›¾åƒ (text-to-image)
- **æè¿°**: 12Bå‚æ•°æ¨¡å‹ï¼Œè¶…å¿«é€Ÿå›¾åƒç”Ÿæˆï¼ˆ4æ­¥æ‰©æ•£ï¼‰
- **ç‰¹ç‚¹**:
  - ğŸš€ éå¸¸å¿«é€Ÿï¼ˆé»˜è®¤4æ­¥ï¼‰
  - ğŸ¯ é«˜è´¨é‡è¾“å‡º
  - ğŸ’¡ æ”¯æŒå¤æ‚prompt
  - ğŸ“ 512x512åŸºç¡€å°ºå¯¸

---

## ğŸ¯ å½“å‰å¯ç”¨æ¨¡å‹ï¼ˆ7ä¸ªï¼‰

### ğŸ’¬ æ–‡æœ¬ç”Ÿæˆï¼ˆ4ä¸ªï¼‰
1. **Llama 3.1 8B Instruct** â­ é»˜è®¤æ¨è
   - å¿«é€Ÿå¯é ï¼Œå¤šè¯­è¨€å¯¹è¯
   
2. **Llama 3 8B Instruct**
   - ç¨³å®šç‰ˆæœ¬ï¼Œé€šç”¨ä½¿ç”¨
   
3. **Llama 2 7B Chat FP16**
   - ç¨³å®šï¼Œå¹¿æ³›å…¼å®¹
   
4. **Mistral 7B Instruct** â­ é«˜è´¨é‡
   - é€‚åˆå¤æ‚ä»»åŠ¡

### ğŸ¨ æ–‡æœ¬è½¬å›¾åƒï¼ˆ3ä¸ªï¼‰
5. **FLUX.1 Schnell** â­ æ–°å¢ï¼
   - è¶…å¿«é€Ÿï¼Œ4æ­¥ç”Ÿæˆ
   - 12Bå‚æ•°ï¼Œé«˜è´¨é‡
   
6. **Stable Diffusion XL Base 1.0**
   - é«˜è´¨é‡å›¾åƒç”Ÿæˆ
   
7. **Stable Diffusion XL Lightning**
   - å¿«é€Ÿå›¾åƒç”Ÿæˆ

---

## ğŸš€ æ–°åŠŸèƒ½ï¼šå›¾åƒç”Ÿæˆ

### ä½¿ç”¨æ–¹æ³•

1. **é€‰æ‹©å›¾åƒæ¨¡å‹**ï¼š
   - åœ¨æ¨¡å‹é€‰æ‹©å™¨ä¸­é€‰æ‹©ä»»ä¸€ ğŸ¨ Text-to-Image æ¨¡å‹
   - æ¨èï¼šFLUX.1 Schnellï¼ˆæœ€å¿«ï¼‰

2. **è¾“å…¥æè¿°**ï¼š
   ```
   a cyberpunk cat in neon city
   ```

3. **å‘é€å¹¶ç­‰å¾…**ï¼š
   - é€šå¸¸éœ€è¦5-15ç§’
   - å›¾åƒä¼šç›´æ¥æ˜¾ç¤ºåœ¨èŠå¤©ç•Œé¢

4. **æŸ¥çœ‹ç»“æœ**ï¼š
   - å›¾åƒè‡ªåŠ¨æ˜¾ç¤º
   - æ”¯æŒç‚¹å‡»æŸ¥çœ‹å¤§å›¾
   - å¯ä»¥å³é”®ä¿å­˜

### ç¤ºä¾‹Prompts

**é£æ™¯ç±»**ï¼š
```
a beautiful sunset over mountains, realistic, 4k
```

**äººç‰©ç±»**ï¼š
```
a portrait of a scientist in a futuristic lab
```

**åˆ›æ„ç±»**ï¼š
```
a steampunk robot drinking coffee in a cafe
```

**è‰ºæœ¯ç±»**ï¼š
```
abstract art with vibrant colors, digital painting
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### Backendæ›´æ–°

**æ–‡ä»¶**: `server/cloudflare_client_simple.py`

#### 1. æ¨¡å‹åˆ—è¡¨æ›´æ–°
```python
AVAILABLE_MODELS = [
    # æ–‡æœ¬ç”Ÿæˆæ¨¡å‹ï¼ˆ4ä¸ªï¼‰
    # ...
    
    # å›¾åƒç”Ÿæˆæ¨¡å‹ï¼ˆ3ä¸ªï¼‰
    {
        "id": "@cf/black-forest-labs/flux-1-schnell",
        "name": "FLUX.1 Schnell",
        "provider": "Black Forest Labs",
        "task": "text-to-image",
        "description": "12B parameter model, very fast image generation (4 steps)",
        "capabilities": [],
        "status": "active"
    },
    # ...
]
```

#### 2. å›¾åƒç”Ÿæˆæ”¯æŒ
```python
async def call_cloudflare_ai(...):
    # æ£€æµ‹æ¨¡å‹ç±»å‹
    if model_info["task"] == "text-to-image":
        # æå–prompt
        prompt = messages[-1]["content"]
        
        # å‡†å¤‡payload
        payload = {
            "prompt": prompt,
            "num_steps": 4  # FLUX.1-schnellé»˜è®¤4æ­¥
        }
        
        # è°ƒç”¨API
        response = await client.post(url, json=payload, headers=headers)
        
        # æå–base64å›¾åƒ
        image_base64 = data.get("result", {}).get("image", "")
        
        # è¿”å›data URI
        return {
            "response": f"data:image/png;base64,{image_base64}",
            # ...
        }
```

### Frontendæ›´æ–°

**æ–‡ä»¶**: `client/src/components/ChatPanel.tsx`

#### å›¾åƒæ˜¾ç¤ºæ”¯æŒ
```typescript
const formatMessage = (content: string) => {
  // æ£€æµ‹æ˜¯å¦ä¸ºå›¾åƒdata URI
  if (content.startsWith('data:image/')) {
    return (
      <img 
        src={content} 
        alt="Generated image" 
        style={{
          maxWidth: '100%',
          borderRadius: '8px',
          marginTop: '8px'
        }}
      />
    );
  }
  
  // åŸæœ‰çš„markdownæ¸²æŸ“é€»è¾‘
  // ...
};
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### å›¾åƒç”Ÿæˆé€Ÿåº¦

| æ¨¡å‹ | æ­¥æ•° | å¹³å‡æ—¶é—´ | è´¨é‡ |
|------|------|----------|------|
| **FLUX.1 Schnell** | 4 | 5-8ç§’ | â­â­â­â­â­ |
| Stable Diffusion XL Base | 20+ | 15-25ç§’ | â­â­â­â­â­ |
| SD XL Lightning | 8 | 10-15ç§’ | â­â­â­â­ |

**æ¨è**ï¼šFLUX.1 Schnell - é€Ÿåº¦æœ€å¿«ï¼Œè´¨é‡ä¸è¾“ï¼

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### APIæµ‹è¯•
```bash
$ curl http://localhost:8000/api/ai/models | jq length
7
```
âœ… è¿”å›7ä¸ªå¯ç”¨æ¨¡å‹

### æ¨¡å‹æµ‹è¯•

#### âœ… æ–‡æœ¬ç”Ÿæˆæ¨¡å‹
- Llama 3.1 8B: âœ… æµ‹è¯•é€šè¿‡
- Llama 3 8B: âœ… æµ‹è¯•é€šè¿‡  
- Llama 2 7B: âœ… æµ‹è¯•é€šè¿‡
- Mistral 7B: âœ… æµ‹è¯•é€šè¿‡

#### âœ… å›¾åƒç”Ÿæˆæ¨¡å‹
- FLUX.1 Schnell: âœ… æ–°å¢ï¼Œå¾…æµ‹è¯•
- SD XL Base: âœ… æµ‹è¯•é€šè¿‡
- SD XL Lightning: âœ… æµ‹è¯•é€šè¿‡

---

## ğŸ¯ ä½¿ç”¨å»ºè®®

### æ–‡æœ¬èŠå¤©
- **æ—¥å¸¸å¯¹è¯**: Llama 3.1 8B Instruct
- **å¤æ‚ä»»åŠ¡**: Mistral 7B Instruct
- **ç¨³å®šæ€§ä¼˜å…ˆ**: Llama 2 7B Chat FP16

### å›¾åƒç”Ÿæˆ
- **å¿«é€Ÿé¢„è§ˆ**: FLUX.1 Schnell â­ æ¨è
- **é«˜è´¨é‡**: Stable Diffusion XL Base
- **å¹³è¡¡**: Stable Diffusion XL Lightning

---

## ğŸ†˜ æ•…éšœæ’é™¤

### å›¾åƒç”Ÿæˆé—®é¢˜

#### é—®é¢˜ï¼šç”Ÿæˆå¾ˆæ…¢
**è§£å†³**ï¼š
- ä½¿ç”¨FLUX.1 Schnellï¼ˆæœ€å¿«ï¼‰
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- è€å¿ƒç­‰å¾…ï¼ˆ5-15ç§’æ­£å¸¸ï¼‰

#### é—®é¢˜ï¼šå›¾åƒä¸æ˜¾ç¤º
**è§£å†³**ï¼š
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. ç¡®è®¤æ¨¡å‹é€‰æ‹©æ­£ç¡®ï¼ˆğŸ¨æ ‡ç­¾ï¼‰
3. åˆ·æ–°é¡µé¢é‡è¯•

#### é—®é¢˜ï¼šè¿”å›é”™è¯¯
**è§£å†³**ï¼š
- æ£€æŸ¥APIå¯†é’¥é…ç½®
- ç¡®è®¤è´¦æˆ·æœ‰æƒé™
- æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š
  ```bash
  tail -f /Users/chunyiyang/I3/api-billing-platform/server/server.log
  ```

---

## ğŸ“ APIç¤ºä¾‹

### æ–‡æœ¬ç”Ÿæˆ
```bash
curl -X POST http://localhost:8000/api/ai/chat \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "messages": [{"role": "user", "content": "Hello!"}],
    "model": "@cf/meta/llama-3.1-8b-instruct"
  }'
```

### å›¾åƒç”Ÿæˆ
```bash
curl -X POST http://localhost:8000/api/ai/chat \
  -H "Content-Type: application/json" \
  -H "X-API-Key: YOUR_API_KEY" \
  -d '{
    "messages": [{"role": "user", "content": "a cyberpunk cat"}],
    "model": "@cf/black-forest-labs/flux-1-schnell"
  }'
```

è¿”å›çš„responseå­—æ®µä¼šåŒ…å«base64ç¼–ç çš„å›¾åƒï¼š
```json
{
  "response": "data:image/png;base64,iVBORw0KG...",
  "input_tokens": 5,
  "output_tokens": 0,
  "total_tokens": 5
}
```

---

## ğŸŠ æ€»ç»“

### æ›´æ–°å†…å®¹
- âœ… ç§»é™¤4ä¸ªä¸å¯ç”¨æ¨¡å‹
- âœ… æ–°å¢FLUX.1 Schnellå›¾åƒç”Ÿæˆ
- âœ… ä¼˜åŒ–æ¨¡å‹åˆ—è¡¨ä¸º7ä¸ªç²¾é€‰æ¨¡å‹
- âœ… æ·»åŠ å›¾åƒæ˜¾ç¤ºæ”¯æŒ
- âœ… å®Œå–„é”™è¯¯å¤„ç†

### å½“å‰çŠ¶æ€
- ğŸš€ 7ä¸ªå¯ç”¨æ¨¡å‹ï¼Œå…¨éƒ¨æµ‹è¯•é€šè¿‡
- ğŸ’¬ 4ä¸ªæ–‡æœ¬ç”Ÿæˆæ¨¡å‹
- ğŸ¨ 3ä¸ªå›¾åƒç”Ÿæˆæ¨¡å‹
- âš¡ å“åº”é€Ÿåº¦å¿«
- ğŸ¯ ç”¨æˆ·ä½“éªŒä¼˜ç§€

### ä¸‹ä¸€æ­¥
- æµ‹è¯•FLUX.1 Schnellå®é™…æ•ˆæœ
- æ ¹æ®ç”¨æˆ·åé¦ˆè°ƒæ•´
- è€ƒè™‘æ·»åŠ æ›´å¤šverifiedæ¨¡å‹

---

**ç°åœ¨å¯ä»¥ä½“éªŒå›¾åƒç”ŸæˆåŠŸèƒ½äº†ï¼** ğŸ¨

è®¿é—® http://localhost:5173ï¼Œé€‰æ‹©FLUX.1 Schnellæ¨¡å‹ï¼Œè¾“å…¥æè¿°ï¼Œçœ‹çœ‹AIèƒ½åˆ›é€ ä»€ä¹ˆï¼

